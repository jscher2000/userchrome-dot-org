<!DOCTYPE html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="icon" type="image/x-icon" href="favicon.ico">
<link rel="icon" type="image/png" sizes="256x256" href="/img/Fxcss_256.png">
<title>Firefox 89+ &ndash; Styling the New Proton UI</title>
<link rel="stylesheet" href="styles.css" type="text/css">
<style>
#tbarsettings td { vertical-align: top; }
#tbarsettings td p { margin-top: 0; }
#tbarsettings select { margin-left: 0.25in; min-width: 200px; }
#tabbar-demo { color: #000; background-color: #f4f4f4; margin: 1em 0; padding: 4px 0; width: 100%; border-bottom: 2px solid #888; float: left; font-family: "Segoe UI", sans-serif; font-size: 12px; }
#tabbar-demo > div { width: 200px; height: 36px; float: left; margin-left: 2px; margin-right: 2px; cursor: default; overflow: hidden; text-overflow: ellipsis; }
#tabbar-demo > div { background-image: url(favicon.ico); background-size: 16px 16px; background-repeat: no-repeat; background-position: 6px 50%; }
#tabbar-demo > div > span { line-height: 36px; margin-left: 29px; white-space: nowrap; }
.backdemo:hover { background-color: rgba(0, 0, 0, 0.11); }
#tabbar-demo.bradius-0px > div { border-radius: 0px; }
#tabbar-demo.bradius-4px > div { border-radius: 4px; }
#tabbar-demo.bradius-6px > div { border-radius: 6px; }
#tabbar-demo.bradius-8px > div { border-radius: 8px; }
#tabbar-demo.compact > div { height: 29px; }
#tabbar-demo.compact > div > span { line-height: 29px; }
#tabbar-demo.connected { padding-top: 1px; padding-bottom: 0px; }
#tabbar-demo.connected > div {border-bottom-right-radius: 0px; border-bottom-left-radius: 0px; }
#tabbar-demo.bar > #back1-demo {
	border-right: 1px solid rgba(0, 0, 0, .20) !important;
}
#tabbar-demo.bar > .backdemo {
	border-radius: 0 !important;
	margin-left: 0 !important;
	margin-right: 0 !important;
}
#tabbar-demo.outline > .backdemo {
	border: 1px solid rgba(0, 0, 0, .20) !important;
	height: 34px;
}
#tabbar-demo.outline.compact > .backdemo {
	height: 27px;
}
#tabbar-demo.outline.connected > .backdemo {
	border-bottom: none !important;
}
#tabbar-demo.outline > div:not(:first-of-type) {
	margin-left: 0 !important;
}
#tabbar-demo.shadow > .backdemo {
	background-color: rgba(0, 0, 0, 0.08); 
}
#tabbar-demo.font12px > div > span { font-size: 12px; }
#tabbar-demo.font13px > div > span { font-size: 13px; }
#tabbar-demo.font14px > div > span { font-size: 14px; }
#tabbar-demo.font15px > div > span { font-size: 15px; }
#tabbar-demo.font16px > div > span { font-size: 16px; }
#tabbar-demo.weight400 > div > span { font-weight: 400; }
#tabbar-demo.weight500 > div > span { font-weight: 500; }
#tabbar-demo.weight600 > div > span { font-weight: 600; }
#tabbar-demo.weight700 > div > span { font-weight: 700; }
#tabbar-demo.weight800 > div > span { font-weight: 800; }
#toc {margin-left: 18px; list-style-type: "â–¶";}
#toc li {margin-top: 2px; margin-bottom: 2px; padding-left: 6px;}
/* Container/Context Line */
#back1-demo::before {
	content: " ";
	display: block;
	position: absolute;
	background-color: #f8f;
	height: 2px;
	width: 196px;
	border-radius: 2px;
	margin: -3px 2px 0;
}
#tabbar-demo.connected  #back1-demo::before {
	margin-top: 0;
}
#tabbar-demo.movecontext #back1-demo::before {
	margin-top: 34px;
}
#tabbar-demo.compact.movecontext #back1-demo::before {
	margin-top: 27px;
}
#back2-demo {
	position: relative;
}
#back2-demo > span {
	line-height: revert !important;
	display: inline-block;
}
#back2-demo > span:nth-of-type(1) {
	margin-top: 4px;
}
#tabbar-demo.compact #back2-demo > span:nth-of-type(1) {
	margin-top: 1px;
}
.tab-secondary-label {
	font-size: 0.75em;
	vertical-align: super;
}
#audiobutton {
	position: absolute;
	display: none;
}
#tabbar-demo:not(.audiobtn) #back2-demo:hover #audiobutton {
	display: inline;
	top: 7px;
	left: 5px;
}
#tabbar-demo.compact:not(.audiobtn) #back2-demo:hover #audiobutton {
	top: 5px;
}
#tabbar-demo.audiobtn #audiobutton {
	display: inline;
	top: 7px;
	left: 22px;
}
#tabbar-demo.compact.audiobtn #audiobutton {
	top: 5px;
}
#tabbar-demo.audiobtn #back2-demo span {
	margin-left: 45px;
}
</style>
</head>
<body>
<nav>
<ul>
<li id="logo">userChrome.org</li>
<li><a href="what-is-userchrome-css.html" title="What is userChrome.css and what can it do?">WHAT</a></li>
<li><a href="how-create-userchrome-css.html" title="How to Create a userChrome.css File">HOW</a></li>
<li><a href="help-with-userchrome-css.html" title="Resources for Style Recipes and Tools">RESOURCES</a></li>
</ul>
<div id="rightnav">
<a href="javascript:void(0);" title="Load AddToAny" onclick="document.getElementById('confa2a').style.display='block';return false;">SHARE</a>
<a href="javascript:void(0);" title="Load Google Translate" onclick="document.getElementById('confgt').style.display='block';return false;">TRANSLATE</a>
<a href="javascript:void(0);" title="Load Comment Panel" onclick="togComments(this);return false;">FEEDBACK</a>
<div id="confa2a" class="yesno">Load script from AddToAny to share this page? (<a href="https://www.addtoany.com/privacy" rel="noopener" target="_blank">Privacy Policy</a>) <span style="position:absolute; right: 8px"><button onclick="loadShare('1', this);">OK</button>&nbsp;<button onclick="document.getElementById('confa2a').style.display='none';">Cancel</button></span></div>
<div id="confgt" class="yesno">Load script from Google Translate to select a language? (<a href="https://www.google.com/intl/en/policies/privacy/" rel="noopener" target="_blank">Privacy Policy</a>) <span style="position:absolute; right: 8px"><button onclick="loadTrans('2', this);">OK</button>&nbsp;<button onclick="document.getElementById('confgt').style.display='none';">Cancel</button></span></div>
<div id="hotnews"><a href="https://www.userchrome.org/megabar-styling-firefox-address-bar.html">Firefox 75 Address Megabar!</a></div>
</div>
</nav>
<header>
<h1>Firefox 89+ &ndash; Styling the New Proton UI</h1>
<p>Updated August 15, 2021; Originally posted by jscher2000 on May 30, 2021.</p>
</header>

<article>
<div id="main">
<p>Before the "Photon" user interface design reached its fourth anniversary, Firefox&nbsp;89 has brought us the "Proton" user interface. The design of the tab bar has been particularly controversial due to its greater height, and the way tabs float. The feeling of spaciousness also extends to the menus. Here are some ideas for modifying these changes if they bother you, and of course you can find additional suggestions on the usual sites (especially r/FirefoxCSS).</p>
<ul id="toc">
	<li><a href="#compactmode" onclick="window.setTimeout(pgshow, 100);">Restoring Compact mode to the density selector</a></li>
	<li><a href="#menuspacing" onclick="window.setTimeout(pgshow, 100);">Tightening up the menu spacing</a></li>
	<li><a href="#tabstyler" onclick="window.setTimeout(pgshow, 100);">Re-styling tab buttons as connected tabs, dividers, height, font size/boldness, audio icon, etc.</a></li>
</ul>

<h3 id="compactmode">Enabling "Compact" Toolbar Density</h3>
<p>Do you miss having "compact" toolbars? The developers have reduced support for Compact mode so if you would like to select it from the Density popup on the Customize screen, you need to change a preference so it appears there:</p>
<ol type="A">
	<li>In a new tab, type or paste <strong>about:config</strong> in the address bar and press Enter/Return. Click the button accepting the risk.</li>
	<li>In the search box in the page, type or paste <strong>compact</strong> and pause while the list is filtered.</li>
	<li>Double-click the <strong>browser.compactmode.show</strong> preference to switch the value from false to true. <em>Now "Compact (not supported)" should appear on the Density popup in the Customize screen.</em></li>
</ol>
<p>Alternately, if you don't plan to use the Density selector frequently, you can modify the density preference directly:</p>
<ol type="A">
	<li>In a new tab, type or paste <strong>about:config</strong> in the address bar and press Enter/Return. Click the button accepting the risk.</li>
	<li>In the search box in the page, type or paste <strong>browser.uidensity</strong> and pause while the list is filtered.</li>
	<li>Double-click the preference to display an editing field, change the value as desired, then press Enter or click the blue check mark button to save the change. These are the available values:
		<br>&nbsp;<br>
		0 =&gt; Normal density (default)<br>
		1 =&gt; Compact density<br>
		2 =&gt; Touch density
	</li>
</ol>
<div style="page-break-inside: avoid;">
<p>This screenshot illustrates the difference in heights:</p>
<p><img src="img/Fx90-about-config-browser-uidensity.png"></p>
</div>
<p style="border-top:1px solid #aaa;">&nbsp;</p>

<h3 id="menuspacing">Reducing vertical spacing in menus</h3>
<p>Most of the menus in Firefox 89 have fewer items, but you still may prefer smaller gaps between the items, especially with long lists like Bookmarks. The main reason items are more widely spaced is the <em>padding</em> along the top and bottom of each item. You can use custom style rules in a userChrome.css file to customize the spacing. For Firefox 89-90, there is a preference to roll back the changes to some menus (next section below).</p>

<p>To take direct control of the padding, you can use CSS code such as the following. If 4 pixels of padding is too high, you could try 2px to try to match Firefox 57-88 (at least on Windows). If it's too low, try 5px. (Comparison screenshots below the code)</p>

<pre class="codeblock notranslate">
/*** Tighten up drop-down/context/popup menu spacing ***/

menupopup > menuitem, menupopup > menu {
  padding-block: 4px !important;
}
:root {
  --arrowpanel-menuitem-padding: 4px 8px !important;
}
</pre>

<div style="page-break-inside: avoid;">
<p>This makes the spacing similar to Firefox 88:</p>

<p><img src="img/Fx90-menu-item-padding.png"></p>
</div>

<div style="page-break-inside: avoid;">
<p>Here are padding-block variations for comparison:</p>

<p><img src="img/Fx91-menu-spacing-4px-3px-2px.png"></p>
</div>
<p style="border-top:1px solid #ccc;">&nbsp;</p>

<p>{<em>Firefox 89-90 only</em>} Here are the steps to switch the temporary preference between the older menu appearance and the Firefox 89 ("Proton") appearance:</p>
<ol type="A">
	<li>In a new tab, type or paste <strong>about:config</strong> in the address bar and press Enter/Return. Click the button accepting the risk.</li>
	<li>In the search box in the page, type or paste <strong>browser.proton.contextmenus.enabled</strong> and pause while the list is filtered.</li>
	<li>Double-click the preference to switch the value between <strong>true</strong> (Proton style) and <strong>false</strong> (Photon style).</li>
</ol>
<p style="border-top:1px solid #aaa;">&nbsp;</p>

<h2 id="tabstyler">Restyling tab buttons</h2>
<p>One of the more controversial changes in Firefox&nbsp;89 was the new appearance of tabs as floating buttons rather than connected tabs. Numerous users have posted solutions to "reconnect" the buttons, to modify their shape and size, and to create more distinct tabs for background/inactive tabs. (For example, <a href="https://github.com/black7375/Firefox-UI-Fix/blob/master/README.org" target="_blank">Lepton</a>.) To adjust the color scheme, I suggest using <a href="https://support.mozilla.org/kb/use-themes-change-look-of-firefox" target="_blank">Themes</a>. For Firefox 89-90, there is a preference to roll back the changed tab design (next section below).</p>

<p>You can use the following controls to generate a personalized rules file to restyle the Firefox 89+ tab bar. The rules can be incorporated directly into a userChrome.css file, or you could include them by reference as described in <a href="adding-style-recipes-userchrome-css.html">Adding Style Recipes to userChrome.css</a>. The buttons to grab the CSS you tweak using the following form controls follow after the form.</p>

<div style="background-color:#f6fcf9;border:4px solid #bfd;padding:4px 12px;">
<table id="tbarsettings" border="0" cellspacing="0" style="border-collapse:collapse;width:100%;">
	<tbody>
		<tr><td colspan="3"><div id="tabbar-demo" class="connected bradius-6px">
				<div id="back1-demo" class="backdemo" title="Tab in a Container"><span>What is userChrome.css? What can it do?</span></div>
				<div id="back2-demo" class="backdemo" title="Background tab playing audio"><svg id="audiobutton" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 12" width="20" height="20" fill="context-fill" fill-opacity="context-fill-opacity"><circle fill="context-stroke" cx="6" cy="6" r="6"/><path fill="context-fill" d="M6.7 2.6v6.8c0 .7-.9 1-1.3.5l-1.7-2H2.2c-.4 0-.7-.3-.7-.8V4.9c0-.4.3-.8.7-.8h1.5l1.7-2c.5-.5 1.3-.2 1.3.5zM8.8 6c0-1-.5-1.9-1.3-2.4v4.7C8.3 7.9 8.8 7 8.8 6zm-.7-4.1c-.2-.1-.4 0-.5.2-.1.2 0 .4.2.5 1.3.7 2 2 2 3.4 0 1.4-.8 2.8-2 3.4-.2.1-.3.2-.3.4 0 .2.2.4.4.4.1 0 .1 0 .2 0 1.5-.8 2.5-2.4 2.5-4.1-.1-1.8-1-3.4-2.5-4.2z"/></svg><span>How to Create a userChrome.css File</span><br><span class="tab-secondary-label">PLAYING</span></div>
				<div id="bradius-demo" style="background-color: #fff; box-shadow: 0 0 1px var(--tab-line-color, rgba(128,128,142,0.9)), 0 0 4px rgba(128,128,142,0.5);" title="Active tab"><span>Firefox 89 &ndash; Styling the New Proton UI</span></div>
			</div></td>
		</tr>
		<tr><td><p>Tab corner rounding: <br>
			<select id="bradius" name="bradius" size="4">
				<option value="0px">None (square corners)</option>
				<option value="4px">4 pixels</option>
				<option value="6px" selected>6 pixels</option>
				<option value="8px">8 pixels</option>
			</select></p>
			<p>Tabs floating or connected: <br>
				<select id="floatflush" name="floatflush" size="2">
					<option value="floating">Let them float (default style)</option>
					<option value="connected" selected>Connect them to the toolbar</option>
				</select></p>
			<p>Tab height: <br>
			<select id="tabheight" name="tabheight" size="2">
				<option value="none" selected>Do not override default</option>
				<option value="compact">Use Compact height</option>
			</select></p></td>
			<td><p>Show inactive tab boundaries: <br>
			<select id="backtabs" name="backtabs" size="4">
				<option value="none" selected>Only on hover (default style)</option>
				<option value="bar">Using a vertical bar</option>
				<option value="shadow">Using a hover-like shadow</option>
				<option value="outline">Using a tab outline</option>
			</select></p><p>Container color line: <br>
			<select id="contextline" name="contextline" size="2">
				<option value="none" selected>Do not override default</option>
				<option value="bottom">Move to bottom of tab</option>
			</select></p><p>Audio playing/mute button visibility: <br>
			<select id="soundbtn" name="soundbtn" size="3">
				<option value="none" selected>Only on hover (default style)</option>
				<option value="regular">While playing (regular tabs only)</option>
				<option value="regpinned">While playing (regular and pinned tabs)</option>
			</select></p></td>
			<td><p>Tab font size: <br>
			<select id="fontsize" name="fontsize" size="6">
				<option value="none" selected>Do not override default</option>
				<option value="12px">12px (default on Windows)</option>
				<option value="13px">13px</option>
				<option value="14px">14px</option>
				<option value="15px">15px</option>
				<option value="16px">16px</option>
			</select></p><p>Tab font weight: <br>
			<select id="fontweight" name="fontweight" size="6">
				<option value="none" selected>Do not override default</option>
				<option value="400">400 (normal weight)</option>
				<option value="500">500</option>
				<option value="600">600</option>
				<option value="700">700 (bold)</option>
				<option value="800">800</option>
			</select></p></td>
		</tr>
	</tbody>
</table>
</div>

<h4>CSS based on above options: <button onclick="selectel('currentCSS'); this.blur();" style="margin-left:4em">Select CSS</button> 
	<button id="savecss" onclick="saveCSS(this);">Save below as .css File</button></h4>
<div id="currentCSS" style="width:100%; font-family:monospace; font-size:0.8em; white-space:pre-wrap; border:1px solid #00f; padding:1em; background-color:#f8f8f8; min-height:300px;">
<p>CSS to be shown here, assuming JavaScript is not disabled.</p>
</div>
<p style="border-top:1px solid #ccc;">&nbsp;</p>

<p>{<em>Firefox 89-90 only</em>} If you are not ready for a userChrome.css approach, here are the steps to switch the temporary preference between the Firefox 57-88 ("Photon") appearance and the Firefox 89-90 ("Proton") appearance. <strong>This causes display problems in Firefox 91, so please reset this to true for Firefox 91.</strong></p>
<ol type="A">
	<li>In a new tab, type or paste <strong>about:config</strong> in the address bar and press Enter/Return. Click the button accepting the risk.</li>
	<li>In the search box in the page, type or paste <strong>browser.proton.enabled</strong> and pause while the list is filtered.</li>
	<li>Double-click the preference to switch the value between <strong>true</strong> (Proton style) and <strong>false</strong> (Photon style).</li>
</ol>
<p style="border-top:1px solid #aaa;">&nbsp;</p>
</div>
</article>

<footer>
<p>Copyright &copy; 2021 Jefferson Scher. All Rights Reserved. CSS examples available under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> or 
<a href="https://opensource.org/licenses/BSD-3-Clause">BSD-3-Clause License</a>. FileSaver.js v1.3.3 &copy; 2016 Eli Grey (<a href="https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md" 
target="_blank">MIT License</a>). <a href="privacy.html">Privacy statement</a>.</p>
</footer>
<script type="text/javascript" src="uc.js"></script>
<script>
function init(){
	// reset selects on reload
	document.getElementById('bradius').selectedIndex = 2;
	document.getElementById('floatflush').selectedIndex = 1;
	document.getElementById('tabheight').selectedIndex = 0;
	document.getElementById('backtabs').selectedIndex = 0;
	document.getElementById('contextline').selectedIndex = 0;
	document.getElementById('soundbtn').selectedIndex = 0;
	document.getElementById('fontsize').selectedIndex = 0;
	document.getElementById('fontweight').selectedIndex = 0;
	// create initial CSS
	buildCSS();
}

// update demo bar and call buildCSS()
function updateDemo(evt){
	var tgt = evt.target;
	var demobar = document.getElementById('tabbar-demo');
	switch (tgt.id){
		case 'bradius':
			for (var i=0; i<tgt.options.length; i++){
				if (tgt.options[i].selected) demobar.classList.add('bradius-' + tgt.options[i].value);
				else demobar.classList.remove('bradius-' + tgt.options[i].value);
			}
			break;
		case 'floatflush':
			if (tgt.value == 'connected') demobar.classList.add('connected');
			else demobar.classList.remove('connected');
			break;
		case 'tabheight':
			if (tgt.value == 'compact') demobar.classList.add('compact');
			else demobar.classList.remove('compact');
			break;
		case 'backtabs':
			for (var i=0; i<tgt.options.length; i++){
				if (tgt.options[i].selected) demobar.classList.add(tgt.options[i].value);
				else demobar.classList.remove(tgt.options[i].value);
			}
			break;
		case 'contextline':
			if (tgt.value == 'bottom') demobar.classList.add('movecontext');
			else demobar.classList.remove('movecontext');
			break;
		case 'fontsize':
			for (var i=0; i<tgt.options.length; i++){
				if (tgt.options[i].selected && tgt.options[i].value != 'none') demobar.classList.add('font' + tgt.options[i].value);
				else demobar.classList.remove('font' + tgt.options[i].value);
			}
			break;
		case 'fontweight':
			for (var i=0; i<tgt.options.length; i++){
				if (tgt.options[i].selected && tgt.options[i].value != 'none') demobar.classList.add('weight' + tgt.options[i].value);
				else demobar.classList.remove('weight' + tgt.options[i].value);
			}
			break;
		case 'soundbtn':
			if (tgt.value != 'none') demobar.classList.add('audiobtn');
			else demobar.classList.remove('audiobtn');
			break;
		default:
			// no action
	}
	window.setTimeout(buildCSS, 200);
}

// CSS div
function buildCSS(evt){
	var ctrls = document.querySelectorAll('#tbarsettings select');
	var cssTemp = '', connected = false;
	for(var i=0; i<ctrls.length; i++){
		switch (ctrls[i].id){
			case 'bradius':
				cssTemp += `/*** Proton Tabs Tweaks ***/

/* Adjust tab corner shape, optionally remove space below tabs */

#tabbrowser-tabs {
    --user-tab-rounding: ${ctrls[i].value};
}

.tab-background {`;
				break;
			case 'floatflush':
				if (ctrls[i].value == 'connected') { // attached
					connected = true;
					cssTemp += `
    border-radius: var(--user-tab-rounding) var(--user-tab-rounding) 0px 0px !important;
    margin-block: 1px 0 !important;
}
#scrollbutton-up, #scrollbutton-down { /* 6/10/2021 */
    border-top-width: 1px !important;
    border-bottom-width: 0 !important;
}
/* Container color bar visibility */
.tabbrowser-tab[usercontextid] > .tab-stack > .tab-background > .tab-context-line {
    margin: 0px max(calc(var(--user-tab-rounding) - 3px), 0px) !important;
}`;
				} else { // floating
					cssTemp += `
    border-radius: var(--user-tab-rounding) !important;
}`;
				}
				cssTemp += `
`;
				break;
			case 'tabheight':
				if (ctrls[i].value == 'compact'){ // override native min-height for tabs
					cssTemp += `
/* Override Normal Density height to Compact Density height only for tabs */

#TabsToolbar, #tabbrowser-tabs {
    --tab-min-height: 29px !important;
}
    /* Tweak for covering a line at the bottom of the active tab on some themes 8/11/2021 */
#main-window[sizemode="normal"] #toolbar-menubar[autohide="true"] + #TabsToolbar, 
#main-window[sizemode="normal"] #toolbar-menubar[autohide="true"] + #TabsToolbar #tabbrowser-tabs {
    --tab-min-height: 30px !important;
}
#scrollbutton-up,
#scrollbutton-down {
    border-top-width: 0 !important;
    border-bottom-width: 0 !important;
}
`;
					if (connected) cssTemp += `
    /* [Connected Tabs] Set a max height based on min-height plus margin-block: 1px 0 */
#TabsToolbar, #TabsToolbar > hbox, #TabsToolbar-customization-target, #tabbrowser-arrowscrollbox  {
    max-height: calc(var(--tab-min-height) + 1px) !important;
}
    /* [Connected Tabs] Adjust padding around icons on buttons to avoid crushed images */
#TabsToolbar-customization-target toolbarbutton > .toolbarbutton-icon, 
#TabsToolbar-customization-target .toolbarbutton-text, 
#TabsToolbar-customization-target .toolbarbutton-badge-stack,
#scrollbutton-up,#scrollbutton-down {
    padding-top: 7px !important;
    padding-bottom: 6px !important;
}
`;
				}
				break;
			case 'contextline':
				if (ctrls[i].value != 'none'){ // move context line to bottom
					cssTemp += `
/* Move container color bar to bottom of tab */

.tabbrowser-tab[usercontextid] > .tab-stack > .tab-background > .tab-context-line {
    margin-top: calc(var(--tab-min-height) - 2px) !important;
}
`;
				}
				break;
			case 'fontsize':
				if (ctrls[i].value != 'none'){ // override native font-size for tabs
					cssTemp += `
/* Override font-size for tabs */

.tabbrowser-tab {
    font-size: ${ctrls[i].value} !important;
}
`;
				}
				break;
			case 'fontweight':
				if (ctrls[i].value != 'none'){ // override native font-weight for tabs
					cssTemp += `
/* Override font-weight for tabs */

.tabbrowser-tab {
    font-weight: ${ctrls[i].value} !important;
}
`;
				}
				break;
			case 'backtabs':
				if (ctrls[i].value == 'bar'){
					cssTemp += `
/* Inactive tabs: Separator line style */

.tabbrowser-tab:not([selected=true]):not([multiselected=true]):not([beforeselected-visible="true"]) .tab-background {
    border-right: 1px solid var(--lwt-background-tab-separator-color, rgba(0, 0, 0, .20)) !important;
}
/* For dark backgrounds */
[brighttext="true"] .tabbrowser-tab:not([selected=true]):not([multiselected=true]):not([beforeselected-visible="true"]) .tab-background {
    border-right: 1px solid var(--lwt-background-tab-separator-color, var(--lwt-selected-tab-background-color, rgba(255, 255, 255, .20))) !important;
}
.tabbrowser-tab:not([selected=true]):not([multiselected=true]) .tab-background {
    border-radius: 0 !important;
}
/* Remove padding between tabs */
.tabbrowser-tab {
    padding-left: 0 !important;
    padding-right: 0 !important;
}
`;
				} else if (ctrls[i].value == 'outline'){
					cssTemp += `
/* Inactive tabs: Outline style */

.tabbrowser-tab:not([selected=true]):not([multiselected=true]) .tab-background {
    border: 1px solid rgba(0, 0, 0, .20) !important;
    /* To pick up a theme background tab separator color, un-comment the following line: */
    /* border: 1px solid var(--lwt-background-tab-separator-color, rgba(0, 0, 0, .20)) !important; */`;
					if (connected) cssTemp += `
    border-bottom-color: transparent !important;`
					cssTemp += `
}
    /* For dark backgrounds */
[brighttext="true"] .tabbrowser-tab:not([selected=true]):not([multiselected=true]) .tab-background {
    border: 1px solid var(--lwt-selected-tab-background-color, rgba(255, 255, 255, .20)) !important;
    /* To pick up a theme background tab separator color, un-comment the following line: */
    /* border: 1px solid var(--lwt-background-tab-separator-color, var(--lwt-selected-tab-background-color, rgba(255, 255, 255, .20))) !important; */`;
					if (connected) cssTemp += `
    border-bottom-color: transparent !important;`
					cssTemp += `
}
/* Remove extra padding between tabs */
.tabbrowser-tab:not(:first-of-type) {
    padding-left: 0 !important;
}
`;
				} else if (ctrls[i].value == 'shadow'){
					cssTemp += `
/* Inactive tabs: Shadow style */

.tabbrowser-tab:not([selected=true]):not([multiselected=true]) .tab-background {
    background-color: color-mix(in srgb, currentColor 8%, transparent);
}
`;
				}
				break;
			case 'soundbtn':
				if (ctrls[i].value != 'none'){ // show audio playing/mute button on regular tabs
					cssTemp += `
/*** Audio Playing / Mute Button side-by-side when sound is playing ***/

#TabsToolbar {
    --user-mute-button-height: 20px;  /* default size is 12px, site icon is 16px */
}

/* Move the mute/unmute button to the right and enlarge it */
.tab-icon-overlay:not([pinned], [sharing], [crashed]):is([soundplaying], [muted]) {
    width: var(--user-mute-button-height) !important;
    height: var(--user-mute-button-height) !important;
    margin-left: calc(var(--user-mute-button-height) / 2 + 2px) !important; /* pushes icon to the right */
    margin-right: 2px !important; /* closes up some space before the text */
    padding: 0 !important; /* allows icon to expand to full size */
}

/* Move the site icon to the left a bit and adjust position */
.tab-icon-stack:not([pinned], [sharing], [crashed]):is([soundplaying], [muted]) > :not(.tab-icon-overlay) {
    margin-left: -4px !important; /* pushes icon to the left */
    margin-top: calc((var(--user-mute-button-height) - 16px) / 2) !important;  /* keep site icon reasonably positioned */
}

/* Override the rules for hover/not hover visibility */
   /* for mute button */
.tabbrowser-tab:not(:hover) .tab-icon-overlay:not([pinned], [sharing], [crashed]):is([soundplaying], [muted]), 
   /* for site icon */
.tabbrowser-tab:hover .tab-icon-stack:not([pinned], [sharing], [crashed]):is([soundplaying], [muted]) > :not(.tab-icon-overlay), 
   /* for site icon with Compact density */
:root[uidensity="compact"] .tab-icon-stack:not([pinned], [sharing], [crashed]):is([soundplaying], [muted]) > :not(.tab-icon-overlay) {
    opacity: 1 !important; /* overrides full transparency with full opacity */
}

/* Color the icon on hover for confirmation or avoidance */
.tab-icon-overlay:not([pinned], [sharing], [crashed]):is([soundplaying], [muted]):hover {
    fill: green !important;
}
[lwthemetextcolor="bright"] .tab-icon-overlay:not([pinned], [sharing], [crashed]):is([soundplaying], [muted]):hover {
    fill: lightgreen !important; /* for dark themes */
}
`;
				}
				if (ctrls[i].value == 'regpinned'){ // also show audio playing/mute button on pinned tabs
					cssTemp += `
/* Tweaked Audio playing/Mute button rules for pinned tabs */
.tab-icon-overlay:not([crashed]):is([pinned], [sharing]):is([soundplaying], [muted]) {
    width: var(--user-mute-button-height) !important;
    height: var(--user-mute-button-height) !important;
    margin-left: 2px !important; /* allow some overlap to reduce expanded width */
    margin-right: -2px !important; /* reduce empty space on the right */
    padding: 0 !important; /* allows icon to expand to full size */
    top: 0 !important; /* align button with site icon */
}
.tab-icon-stack:not([crashed]):is([pinned], [sharing]):is([soundplaying], [muted]) > :not(.tab-icon-overlay) {
    margin-left: -6px !important; /* reduce empty space on the left */
    margin-top: calc((var(--user-mute-button-height) - 16px) / 2) !important;  /* keep site icon reasonably positioned */
}
.tabbrowser-tab:not(:hover) .tab-icon-overlay:not([crashed]):is([pinned], [sharing]):is([soundplaying], [muted]), 
   /* for site icon */
.tabbrowser-tab:hover .tab-icon-stack:not([crashed]):is([pinned], [sharing]):is([soundplaying], [muted]) > :not(.tab-icon-overlay), 
   /* for site icon with Compact density */
:root[uidensity="compact"] .tab-icon-stack:not([crashed]):is([pinned], [sharing]):is([soundplaying], [muted]) > :not(.tab-icon-overlay) {
    opacity: 1 !important; /* overrides full transparency with full opacity */
}
.tab-icon-overlay:not([crashed]):is([pinned], [sharing]):is([soundplaying], [muted]):hover {
    fill: green !important;
}
[lwthemetextcolor="bright"] .tab-icon-overlay:not([crashed]):is([pinned], [sharing]):is([soundplaying], [muted]):hover {
    fill: lightgreen !important; /* for dark themes */
}
`;
				}
				break;
			default:
				// ?
		}
	}
	var d = new Date();
	document.getElementById('currentCSS').textContent = cssTemp + `
/* Tweak Options as of 8/13/2021; Generated ${d.toString()} */`;
}

function selectel(elid){
	var el=document.getElementById(elid);
	if (el){
		var sel = window.getSelection();
		sel.removeAllRanges();
		var rng = document.createRange();
		rng.selectNode(el);
		sel.addRange(rng);
	}
	return false;
}
function saveCSS(btn){
	var dummy = document.createElement('div');
	dummy.innerHTML = document.getElementById('currentCSS').innerHTML.replace(/\<br\>/gi, '<br>\n');
	saveAs(
		  new Blob(
			  [dummy.textContent.replace(/\x0a/g, "\x0d\x0a")]
			, {type: 'text/css;charset=UTF-8'}
		)
		, 'userChrome-proton-tab-tweaks.css'
		, true
	);
}
document.getElementById('tbarsettings').addEventListener('change', updateDemo, false);
window.addEventListener('load', init, false);
</script>
<script type="text/javascript" src="FileSaver.min.js"></script>
</body>
</html>